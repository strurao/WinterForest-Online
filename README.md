# 2D Online Sync
μ¨λΌμΈ λ©€ν‹°ν”λ μ΄μ–΄ ν”„λ΅μ νΈλ΅, ``IOCP Server`` μ™€ κ°„λ‹¨ν• ``2D Client`` λ¥Ό λ§λ“¤μ–΄μ„ μ›€μ§μ„κ³Ό κ³µκ²© κΈ°λ¥μ„ λ™κΈ°ν™”ν–μµλ‹λ‹¤.

## κ°λ° ν™κ²½ π› 
- C++
- Windows API
- Visual Studio 2022

## ν”„λ΅μ νΈ μ„¤λ… π—‚
- DummyClient : λ©€ν‹°μ¤λ λ“ μ—°μµμ© Dummy ν΄λΌμ΄μ–ΈνΈ ν”„λ΅μ νΈ
- Server : μ„λ²„ λ΅μ§
- ServerCore : IOCP μ„λ²„ λΌμ΄λΈλ¬λ¦¬
- Zelda2D : ν΄λΌμ΄μ–ΈνΈ λ΅μ§

## κΈ°λ¥ π•Ή
- 2D TileMap Top-down κ²μ„μ΄λ©° ν”λ μ΄μ–΄μ™€ λ¬μ¤ν„°λ” κ³µκ²© λ° μ΄λ™ κΈ°λ¥μ΄ κ°€λ¥ν•κ³ , ν”λ μ΄μ–΄λ¥Ό μ«“μ•„μ¤κ³  κ³µκ²©ν•λ” λ±€ λ¬μ¤ν„°μ—κ² κ³µκ²©μ„ λ‹Ήν•κ±°λ‚ κ°€ν•  μ μμµλ‹λ‹¤.
  - ``State Pattern`` μΌλ΅ ``Creature`` (Player, Monster) μ ``State`` μ •λ³΄ (IDLE, MOVE, SKILL) μ™€ ``Direction`` μ •λ³΄ (UP, DOWN, LEFT, RIGHT) μ— λ”°λΌ λ΅μ§μ„ μ²λ¦¬ν•΄μ£Όμ—μµλ‹λ‹¤.
  - λ±€ λ¬μ¤ν„°λ” ``A*`` μ•κ³ λ¦¬μ¦μΌλ΅ ν”λ μ΄μ–΄λ¥Ό μ«“μ•„μ¤λ” κΈΈμ„ νƒμƒ‰ν•κ³  μ„λ²„μ—μ„ μ—°μ‚°ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ—κ² ``Broadcast`` ν•΄μ¤λ‹λ‹¤.

- IOCP λ¨λΈ μ„λ²„
  - ``IocpCore`` ν΄λμ¤μ—μ„ ``IocpQueue`` (Completion Port) λ¥Ό κµ¬ν„ν•κ³ , ``IocpObject`` (Session, Listener) λ¥Ό Register ν•κ³  μ‘μ—…μ„ μ§„ν–‰ν•  λ• ``EventType`` (Accept, Connect, Disconnect, Recv, Send) μ— λ”°λΌ λΉ„λ™κΈ° ν•¨μλ΅ μ²λ¦¬ν•  μ μλ„λ΅ ν•΄μ£Όμ—μµλ‹λ‹¤.
  - μ„λ²„μ ``Session`` ν΄λμ¤λ” ν΄λΌμ΄μ–ΈνΈμ— λ€ν• μ •λ³΄λ¥Ό κ°€μ§€κ³  μμΌλ©°, ``Session`` μ€ ν΄λΌμ΄μ–ΈνΈμ μ •λ³΄μ— λ€ν• μ¤λ§νΈ ν¬μΈν„°λ¥Ό κ°€μ§€κ³  μμ–΄μ„ reference counting μ„ ν•μ—¬, ``IocpQueue`` μ—μ„ μ‚¬λΌμ§ λ• (μ ‘μ†μ΄ λκΈ°κ±°λ‚ κ²μ„μ„ μΆ…λ£ν•λ” λ“±μ μƒν™©μ—μ„) λ°μƒ κ°€λ¥ν• λ©”λ¨λ¦¬ λ¬Έμ λ¥Ό λ°©μ§€ν•΄μ¤λ‹λ‹¤.
  - ν΄λΌμ΄μ–ΈνΈλ” ``ServerSession`` μΌλ΅ μ„λ²„μ™€μ ν†µμ‹ μ„ ν•  μ μκ³ , μ„λ²„λ” ``GameSession`` μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ™€ ν†µμ‹ ν•  μ μμµλ‹λ‹¤.

- μ΄λ™ λ™κΈ°ν™”
  - ν΄λΌμ΄μ–ΈνΈκ°€ μ΄λ™ν• ν›„ μ„λ²„μ— ν†µμ§€ν•λ” λ°©μ‹μΌλ΅ μ‘μ—…ν–μµλ‹λ‹¤.
  - ν΄λΌμ΄μ–ΈνΈμ ``State``, ``Direction``, ``CellPos``(X,YμΆν‘) μ„Έ κ°€μ§€ μ¤‘ ν•λ‚λΌλ„ λ°”λ€λ” κ²ƒμ„ λ§¤ ν”„λ μ„λ§λ‹¤ ν™•μΈν•΄μ£Όκ³ , κ΄€λ ¨ ν¨ν‚·μ„ μ„λ²„μ— μ „μ†΅ν•λ©΄
  - μ„λ²„μ ``ServerPacketHandler`` μ—μ„ μ²λ¦¬ ν›„ ν΄λΌμ΄μ–ΈνΈλ“¤μ—κ² ``Broadcast`` ν•΄μ£Όκ³ , κ° ν΄λΌμ΄μ–ΈνΈλ” ``Broadcast`` λ°›μ€ μ •λ³΄λ¥Ό μ²λ¦¬ν•΄μ¤λ‹λ‹¤.

- ν¨ν‚· κ΄€λ¦¬
  - ``Google Protocol Buffers`` λ¥Ό μ‚¬μ©ν•μ—¬ ν”λ μ΄μ–΄μ μ…μ¥, ν‡΄μ¥, μ΄λ™μ— κ΄€ν• ν”„λ΅ν† μ½μ„ μ •μν• ν›„ ν¨ν‚·μ μ§λ ¬ν™”/μ—­μ§λ ¬ν™”λ¥Ό ν•΄μ£Όκ³ ,
  - μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” κ°κ° ``ServerPacketHandler``, ``ClientPacketHandler`` μ—μ„ λ¶„κΈ°μ²λ¦¬μ™€ νμ‹±μ„ ν•΄μ¤λ‹λ‹¤.


## μ†κ° λ§ν¬ π¬
- [Youtube](https://youtu.be/iOhF693v0tQ?si=GSckKGGXk10lnnF2)
![image](https://github.com/strurao/WinterForest-Online/assets/126440235/c55b81cb-56ec-46c0-b619-b99e4a5a314f)
